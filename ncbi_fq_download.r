library(dplyr)
# FQ_ID<-c("SRR14610569")
#FQ_ID<-c("SRR14610569", "SRR14610570", "SRR14610571", "SRR14610572", "SRR14610573", "SRR14610574", "SRR14610575", "SRR14610576", "SRR14610577", "SRR14610578", "SRR14610579", "SRR14610580", "SRR14610581", "SRR14610582", "SRR14610583", "SRR14610584", "SRR14610585", "SRR14610586", "SRR14610587", "SRR14610588", "SRR14610589", "SRR14610590", "SRR14610591", "SRR14610592", "SRR14610593", "SRR14610594", "SRR14610595", "SRR14610596", "SRR14610597", "SRR14610598", "SRR14610599", "SRR14610600", "SRR14610601", "SRR14610602", "SRR14610603", "SRR14610604", "SRR14610605", "SRR14610606", "SRR14610607", "SRR14610608", "SRR14610609", "SRR14610610", "SRR14610611", "SRR14610612", "SRR14610613", "SRR14610614", "SRR14610615", "SRR14610616", "SRR14610617", "SRR14610618", "SRR14610619", "SRR14610620", "SRR14610621", "SRR14610622", "SRR14610623", "SRR14610624", "SRR14610625", "SRR14610626", "SRR14610627", "SRR14610628", "SRR14610629", "SRR14610630", "SRR14610631", "SRR14610632", "SRR14610633", "SRR14610634", "SRR14610635", "SRR14610636", "SRR14610637", "SRR14610638", "SRR14610639", "SRR14610640", "SRR14610641", "SRR14610642", "SRR14610643", "SRR14610644", "SRR14610645", "SRR14610646", "SRR14610647", "SRR14610648", "SRR14610649", "SRR14610650", "SRR14610651", "SRR14610652", "SRR14610653", "SRR14610654", "SRR14610655", "SRR14610656", "SRR14610657", "SRR14610658", "SRR14610659", "SRR14610660", "SRR14610661", "SRR14610662", "SRR14610663", "SRR14610664", "SRR14610665", "SRR14610666", "SRR14610667", "SRR14610668", "SRR14610669", "SRR14610670", "SRR14610671", "SRR14610672", "SRR14610673", "SRR14610674", "SRR14610675", "SRR14610676", "SRR14610677","SRR14610678","SRR14610679","SRR14610680","SRR14610681","SRR14610682","SRR14610683","SRR14610684","SRR14610685","SRR14610686","SRR14610687","SRR14610688","SRR14610689","SRR14610690","SRR14610691","SRR14610692","SRR14610693","SRR14610694","SRR14610695","SRR14610696","SRR14610697","SRR14610698","SRR14610699","SRR14610700","SRR14610701","SRR14610702","SRR14610703","SRR14610704","SRR14610705","SRR14610706","SRR14610707","SRR14610708","SRR14610709","SRR14610710","SRR14610711","SRR14610712","SRR14610713","SRR14610714","SRR14610715","SRR14610716","SRR14610717","SRR14610718","SRR14610719","SRR14610720","SRR14610721","SRR14610722","SRR14610723","SRR14610724","SRR14610725","SRR14610726","SRR14610727","SRR14610728","SRR14610729","SRR14610730","SRR14610731","SRR14610732","SRR14610733","SRR14610734")

FQ_ID<-c("ERR1018185","ERR1018186","ERR1018187","ERR1018188","ERR1018189","ERR1018190","ERR1018191","ERR1018192","ERR1018193","ERR1018194","ERR1018195","ERR1018196","ERR1018197","ERR1018198","ERR1018199","ERR1018200","ERR1018201","ERR1018202","ERR1018203","ERR1018204","ERR1018205","ERR1018206","ERR1018207","ERR1018208","ERR1018209","ERR1018210","ERR1018211","ERR1018212","ERR1018213","ERR1018214","ERR1018215","ERR1018216","ERR1018217","ERR1018218","ERR1018219","ERR1018220","ERR1018221","ERR1018222","ERR1018223","ERR1018224","ERR1018225","ERR1018226","ERR1018227","ERR1018228","ERR1018229","ERR1018230","ERR1018231","ERR1018232","ERR1018233","ERR1018234","ERR1018235","ERR1018236","ERR1018237","ERR1018238","ERR1018239","ERR1018240","ERR1018241","ERR1018242","ERR1018243","ERR1018244","ERR1018245","ERR1018246","ERR1018247","ERR1018248","ERR1018249","ERR1018250","ERR1018251","ERR1018252","ERR1018253","ERR1018254","ERR1018255","ERR1018256","ERR1018257","ERR1018258","ERR1018259","ERR1018260","ERR1018261","ERR1018262","ERR1018263","ERR1018264","ERR1018265","ERR1018266","ERR1018267","ERR1018268","ERR1018269","ERR1018270","ERR1018271","ERR1018272","ERR1018273","ERR1018274","ERR1018275","ERR1018276","ERR1018277","ERR1018278","ERR1018279","ERR1018280","ERR1018281","ERR1018282","ERR1018283","ERR1018284","ERR1018285","ERR1018286","ERR1018287","ERR1018288","ERR1018289","ERR1018290","ERR1018291","ERR1018292","ERR1018293","ERR1018294","ERR1018295","ERR1018296","ERR1018297","ERR1018298","ERR1018299","ERR1018300","ERR1018301","ERR1018302","ERR1018303","ERR1018304","ERR1018305","ERR1018306","ERR1018307","ERR1018308","ERR1018309","ERR1018310","ERR1018311","ERR1018312")

for(i in FQ_ID){
  all_file<-list.files()
  if(grepl(i,all_file) %>% any()!=TRUE){
    print(i)
    print("download FQ")
    cmd1<-sprintf(' /home/zhiyu/data/software/anaconda3/bin/ffq --ftp %s  | grep "ftp.sra" | sed "s/\\"url\\"://g" | sed -n 1p |xargs  curl -O',i)
    cmd2<-sprintf(' /home/zhiyu/data/software/anaconda3/bin/ffq --ftp %s  | grep "ftp.sra" | sed "s/\\"url\\"://g" | sed -n 2p | xargs  curl -O',i)
    print(cmd1)
    print(cmd2)
    system(cmd1)
    system(cmd2)
    
    # system('''ffq --ftp $ID | grep -Eo '"url": "[^"]*"' | grep -o '"[^"]*"$' | xargs echo| cut -d " " -f1 | xargs curl -O''')
    # system('''ffq --ftp $ID | grep -Eo '"url": "[^"]*"' | grep -o '"[^"]*"$' | xargs echo| cut -d " " -f2 | xargs curl -O''')
  }
  
}

#获取md5方法1
for(i in FQ_ID){
  # i<-"SRR14610569"
  all_file<-list.files()
  if(grepl(i,all_file) %>% any() !=TRUE ){
    print(i)
    print("download FQ")
    
    # get md5
    system("touch all.md5")
    cmd3<-sprintf('/home/zhiyu/data/software/anaconda3/bin/ffq --ftp %s | jq -r ".[] | \\"\\(.filename) \\(.md5)\\"" >> all.md5',i)
    # cmd3<-sprintf(' /home/zhiyu/data/software/anaconda3/bin/ffq --ftp %s  | jq -r ".[] | "\\(.filename) \\(.md5)" " >> md5.id.txt ',i)
    print(cmd3)
    #system(cmd3)
    
    # # get filename
    # system("touch md5.filename.txt")
    # cmd5<-sprintf(' /home/zhiyu/data/software/anaconda3/bin/ffq --ftp %s  | jq -r ".[] | .filename" >> md5.filename.txt ',i)
    # print(cmd5)
    # system(cmd5)    
    
  }
  
}


#paste md5.id.txt md5.filename.txt > md5.all.txt

#获取md5方法2
##pip3 install jtbl


